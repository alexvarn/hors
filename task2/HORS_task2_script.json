{"files":[{"id":"e09612f8-ff1d-4845-bf7d-2353465768bc","name":"Код","type":"server_js","source":"function getJSON() {\n  var SERVICE_KEY \u003d \u002750677d2550677d2550677d25865016cb815506750677d250ed589def29b43f96a81b492\u0027;\n  var GROUP_NAME \u003d \u0027whoinrussia\u0027;\n  var NUMBER_POST \u003d 5\n  var url \u003d \u0027https://api.vk.com/method/wall.get?\u0026access_token\u003d\u0027 + SERVICE_KEY + \u0027\u0026domain\u003d\u0027 + GROUP_NAME + \u0027\u0026v\u003d5.103\u0027;\n  var response \u003d UrlFetchApp.fetch(url); \n  var jsonObj \u003d JSON.parse(response); \n  headerPrint()\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet();\n  for (let i \u003d 0; i \u003c (NUMBER_POST + 1); i++) { \n    var cell \u003d sheet.getActiveSheet().getRange(i+2, 1).setValue(jsonObj[\u0027response\u0027][\u0027items\u0027][i][\u0027id\u0027]);\n    var cell \u003d sheet.getActiveSheet().getRange(i+2, 2).setValue(parseData(jsonObj[\u0027response\u0027][\u0027items\u0027][i][\u0027date\u0027]));\n    var cell \u003d sheet.getActiveSheet().getRange(i+2, 3).setValue(jsonObj[\u0027response\u0027][\u0027items\u0027][i][\u0027text\u0027]);\n    \n    var url_image \u003d jsonObj[\u0027response\u0027][\u0027items\u0027][i][\u0027attachments\u0027][0][\u0027photo\u0027][\u0027sizes\u0027][2][\u0027url\u0027];\n    var image_height \u003d jsonObj[\u0027response\u0027][\u0027items\u0027][i][\u0027attachments\u0027][0][\u0027photo\u0027][\u0027sizes\u0027][2][\u0027height\u0027];\n    var cell \u003d sheet.getActiveSheet().setRowHeight(i+2, (image_height + 10));\n    var cell \u003d sheet.getActiveSheet().insertImage(url_image,4,i+2);\n     \n  //Logger.log(jsonObj[\u0027response\u0027][\u0027items\u0027][i][\u0027attachments\u0027][0][\u0027photo\u0027][\u0027sizes\u0027][0][\u0027url\u0027]);\n  }\n}\n\n\nfunction parseData(timeStamp) {\n        var date \u003d new Date()\n        date.setTime(timeStamp*1000)\n        var hours \u003d date.getHours();\n        var minutes \u003d date.getMinutes();\n        if (minutes \u003d\u003d 0) {\n          minutes \u003d \u002700\u0027;\n          }\n        var seconds \u003d date.getSeconds();\n        var day \u003d date.getDate();\n        var month \u003d date.getMonth();\n        var year \u003d date.getFullYear();\n        return day + \".\" + month + \".\" + year + \" \" + hours + \":\" + minutes \n        // + \":\" + seconds;\n    }\n\nfunction headerPrint() {\n  var sheet \u003d SpreadsheetApp.getActiveSpreadsheet();\n  var cell \u003d sheet.getActiveSheet().getRange(1, 1).setValue(\u0027id Поста\u0027);\n  var cell \u003d sheet.getActiveSheet().getRange(1, 2).setValue(\u0027Дата\u0027);\n  var cell \u003d sheet.getActiveSheet().getRange(1, 3).setValue(\u0027Подпись\u0027);\n  var cell \u003d sheet.getActiveSheet().getRange(1, 4).setValue(\u0027Картинка из поста (не ссылка)\u0027);\n    }\n\n\n"},{"id":"c99aa09d-ad84-4df2-b426-eb420bdbd2ca","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Europe/Moscow\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"}]}